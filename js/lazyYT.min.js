/*!
* lazyYT (lazy load YouTube videos)
* v1.3.0 - 2016-03-06
* (CC) This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.
* http://creativecommons.org/licenses/by-sa/4.0/
* Contributors: https://github.com/tylerpearson/lazyYT/graphs/contributors || https://github.com/daugilas/lazyYT/graphs/contributors
* 
* Usage: <div class="lazyYT" data-youtube-id="laknj093n" data-parameters="rel=0">loading...</div>
*/

!function(a){"use strict";function b(b,d){var m,o,e=b.data("width"),g=b.data("height"),h=b.attr("title")||b.data("title"),i=b.data("display-title"),j=b.data("ratio")?b.data("ratio"):d.default_ratio,k=b.data("display-duration"),l=b.data("youtube-id"),n=[],q=b.text()?b.text():d.loading_text,r=["https://www.googleapis.com/youtube/v3/videos?id=",l,"&key=",d.yt_api_key,"&part=snippet"].join(""),s=b.data("parameters")||"";j=j.split(":"),s+="&"+d.youtube_parameters,"boolean"!=typeof i&&(i=d.display_title),"boolean"!=typeof k&&(k=d.display_duration),"number"===typeof e&&"number"===typeof g?(b.width(e),m=g+"px"):"number"===typeof e?(b.width(e),m=e*j[1]/j[0]+"px"):(e=b.width(),0==e&&(e=b.parent().width()),m=j[1]/j[0]*100+"%"),n.push('<div class="ytp-thumbnail">'),n.push('<button class="ytp-large-play-button ytp-button" tabindex="23" aria-live="assertive"'),e<=320?n.push(' style="transform: scale(0.61);"'):e<=640&&n.push(' style="transform: scale(0.85);"'),i&&h&&n.push(' aria-label="',h,'"'),n.push(">"),n.push('<svg height="100%" version="1.1" viewBox="0 0 68 48" width="100%">'),n.push('<path class="ytp-large-play-button-bg" d="m .66,37.62 c 0,0 .66,4.70 2.70,6.77 2.58,2.71 5.98,2.63 7.49,2.91 5.43,.52 23.10,.68 23.12,.68 .00,-1.3e-5 14.29,-0.02 23.81,-0.71 1.32,-0.15 4.22,-0.17 6.81,-2.89 2.03,-2.07 2.70,-6.77 2.70,-6.77 0,0 .67,-5.52 .67,-11.04 l 0,-5.17 c 0,-5.52 -0.67,-11.04 -0.67,-11.04 0,0 -0.66,-4.70 -2.70,-6.77 C 62.03,.86 59.13,.84 57.80,.69 48.28,0 34.00,0 34.00,0 33.97,0 19.69,0 10.18,.69 8.85,.84 5.95,.86 3.36,3.58 1.32,5.65 .66,10.35 .66,10.35 c 0,0 -0.55,4.50 -0.66,9.45 l 0,8.36 c .10,4.94 .66,9.45 .66,9.45 z" fill="#1f1f1e" fill-opacity="0.9"></path>'),n.push('<path d="m 26.96,13.67 18.37,9.62 -18.37,9.55 -0.00,-19.17 z" fill="#fff"></path>'),n.push('<path d="M 45.02,23.46 45.32,23.28 26.96,13.67 43.32,24.34 45.02,23.46 z" fill="#ccc"></path>'),n.push("</svg>"),n.push("</button>"),n.push('<div class="ytp-spinner" data-layer="4">'),n.push('<span class="ytp-spinner-svg">'),n.push('<svg height="100%" version="1.1" viewBox="0 0 22 22" width="100%">'),n.push('<svg x="7" y="1"><circle class="ytp-spinner-dot ytp-spinner-dot-0" cx="4" cy="4" r="2"></circle></svg>'),n.push('<svg x="11" y="3"><circle class="ytp-spinner-dot ytp-spinner-dot-1" cx="4" cy="4" r="2"></circle></svg>'),n.push('<svg x="13" y="7"><circle class="ytp-spinner-dot ytp-spinner-dot-2" cx="4" cy="4" r="2"></circle></svg>'),n.push('<svg x="11" y="11"><circle class="ytp-spinner-dot ytp-spinner-dot-3" cx="4" cy="4" r="2"></circle></svg>'),n.push('<svg x="7" y="13"><circle class="ytp-spinner-dot ytp-spinner-dot-4" cx="4" cy="4" r="2"></circle></svg>'),n.push('<svg x="3" y="11"><circle class="ytp-spinner-dot ytp-spinner-dot-5" cx="4" cy="4" r="2"></circle></svg>'),n.push('<svg x="1" y="7"><circle class="ytp-spinner-dot ytp-spinner-dot-6" cx="4" cy="4" r="2"></circle></svg>'),n.push('<svg x="3" y="3"><circle class="ytp-spinner-dot ytp-spinner-dot-7" cx="4" cy="4" r="2"></circle></svg>'),n.push("</svg>"),n.push("</span>"),n.push('<div class="ytp-spinner-message" style="display: none;">If playback doesn\'t begin shortly, try restarting your device.</div>'),n.push("</div>"),k&&n.push('<span class="video-time" style="display:none;"></span>'),n.push("</div>"),i&&(n.push('<div class="ytp-gradient-top"></div>'),n.push('<div class="ytp-chrome-top">'),n.push('<div class="ytp-title">'),n.push('<div class="ytp-title-text">'),n.push('<a id="lazyYT-title-',l,'" class="ytp-title-link" tabindex="13" target="_blank" data-sessionlink="feature=player-title" href="https://www.youtube.com/watch?v=',l,'">'),n.push(h?h:q),n.push("</a>"),n.push("</div>"),n.push("</div>"),n.push("</div>")),b.css({"padding-bottom":m}).html(n.join("")),o=b.find(".ytp-thumbnail").on("click",function(a){a.preventDefault(),b.hasClass(d.video_loaded_class)||(b.html('<iframe src="//www.youtube.com/embed/'+l+"?"+s+'&autoplay=1&enablejsapi=1" frameborder="0" allowfullscreen></iframe>').addClass(d.video_loaded_class),"function"==typeof d.callback&&d.callback.call(b))}),c(l,e,o,r),(!h&&i||k)&&(k&&(r+=",contentDetails"),a.getJSON(r,function(a){var c=a.items[0];b.find("#lazyYT-title-"+l).text(c.snippet.title),k&&b.find(".video-time").text(f(c.contentDetails.duration,d)).show()}))}function c(b,c,f,g){var h,i,j=new Image;0==c&&(c=f.width()),h=c>640?"maxresdefault.jpg":c>480?"sddefault.jpg":c>320?"hqdefault.jpg":c>120?"mqdefault.jpg":0==c?"hqdefault.jpg":"default.jpg",i=["https://img.youtube.com/vi/",b,"/",h].join(""),j.onload=function(b){var h=e(b,"naturalWidth");h<c?a.getJSON(g,function(a){var b=a.items[0],e=b.snippet.thumbnails;0==c&&(c=f.width()),i=c>640&&"object"==typeof e.maxres?e.maxres.url:c>480&&"object"==typeof e.standard?e.standard.url:c>320&&"object"==typeof e.high?e.high.url:c>120&&"object"==typeof e.medium?e.medium.url:e["default"].url,d(f,i)}):d(f,this.src)},j.src=i}function d(a,b){a.css({"background-image":["url(",b,")"].join("")}).addClass("lazyYT-image-loaded")}function e(a){var c;return c="object"==typeof a.path?a.path[0]:"object"==typeof a.target?a.target:a.originalTarget,c.naturalWidth}function f(a){for(var c=[],d=0,e=a.match(/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)W)?(?:(\d*)D)?T(?:(\d*)H)?(?:(\d*)M)?(?:(\d*)S)?/i),f=[{pos:1,multiplier:31536e3},{pos:2,multiplier:2592e3},{pos:3,multiplier:604800},{pos:4,multiplier:86400},{pos:5,multiplier:3600},{pos:6,multiplier:60},{pos:7,multiplier:1}],g=0;g<f.length;g++)"undefined"!=typeof e[f[g].pos]&&(d+=parseInt(e[f[g].pos])*f[g].multiplier);return d>3599&&(c.push(parseInt(d/3600)),d%=3600),c.push(("0"+parseInt(d/60)).slice(-2)),c.push(("0"+d%60).slice(-2)),c.join(":")}a.fn.lazyYT=function(c,d){var e={yt_api_key:c,youtube_parameters:"rel=0",loading_text:"Loading...",display_title:!0,default_ratio:"16:9",display_duration:!1,callback:null,video_loaded_class:"lazyYT-video-loaded",container_class:"lazyYT-container"},f=a.extend(e,d);return this.each(function(){var c=a(this).addClass(f.container_class);b(c,f)})}}(jQuery);